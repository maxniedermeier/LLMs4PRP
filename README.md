# LLM-based Permission Request Processing

This repository contains data and evaluation scripts used in a scientific paper (currently under review) that explores the use of Large Language Models (LLMs) for translating natural-language permission requests into RBAC permissions and roles.

Once the paper is published, a link to the publication will be provided here.

## Overview

In this study, we conducted a series of experiments to quantitatively evaluate how model size and document embeddings influence an LLM's ability to translate permission requests into the corresponding permissions and roles in an RBAC structure.

Each experiment involved prompting an LLM with:

1. A **System Prompt** to instruct the LLM on how to process permission requests.
2. A set of **User Prompts** simulating permission requests in natural language.

Optionally, the LLM also received:

3. An **RBAC Structure** (referred to as the "Enterprise Document" in the paper), showing existing roles, permission names, and their assignments.

## Repository Structure

### System Prompts (see /src/system_prompts)

Each file contains the system prompt which we used for two different experiments. The filename suffix indicates which experiments the prompt was used in (e.g., *SystemPrompt_E1E2.txt* was used in Experiments E1 and E2).

### User Prompts (see /src/user_prompts)

Each file contains 100 simulated permission requests. These were transformed from existing permission descriptions found in Microsoft repositories:

- *UserPrompts_Entra.txt* contains permission requests which are based on permission descriptions found in the **Microsoft Entra built-in roles**.
- *UserPrompts_AzureStorage.txt* contains permission requests which are based on permission descriptions found in the **Azure built-in roles for Storage**.

Example transformation:
The original permission description "Create and manage backup jobs" was transformed to the permission request "I need to create and manage backup jobs."

### RBAC Structures (see /src/RBAC_structure)

These two JSON-structured text files represent role-to-permission mappings from the same two data sources:

- *ED_Entra.txt* contains the **Microsoft Entra built-in roles**.
- *ED_AzureStorage.txt* contains the **Azure built-in roles for Storage**.

These files were used as document embeddings provided to LLMs in some experiments.

### Outputs and Evaluation (see /src/output)

This directory contains two sub-directories: /LLM-Only contains the permission and role suggestions solely generated by LLMs. Before uploading the files, we slightly modified those (as described in the beginning of Subsection 4.2). The file names indicate the corresponding experiments (e.g., *output_E1.csv* describes the results of experiment E1).

The subdirectory /Hybrid contains the output files used when evaluating the hybrid experiments. While the permission translations are copied from the experiments that can be found in the /LLM-Only subdirectory, the role suggestions were created by applying the FindRole algorithm. The file names indicate the corresponding experiments (e.g., *output_EH1_NoPOLP.csv* describes the results of applying the RoleFind algorithm with boolean parameter POLP = False and using the permission translations from experiment E1).

### Request-to-Permission Mapping (see /src/request_permission_mappings)

Each file contains a ground-truth mapping between user prompts and the corresponding permission names.

- *SolutionMapping_Entra.csv* contains a mapping between the user prompts from *UserPrompts_Entra.txt* and permissions from the **Microsoft Entra built-in roles**.
- *SolutionMapping_AzureStorage.csv* contains a mapping between user prompts from *UserPrompts_AzureStorage.txt* and permissions from the **Azure built-in roles for Storage**.

### Evaluation Scripts (see /src/evaluation_scripts)

Python scripts which helped us to evaluate the performance of the LLM predictions. The specific evaluation metrics are described in Section 3 of the paper.

### FindRole (see /src/FindRole)

Includes a Python script that implement the FindRole Algorithm as shown in Subsection 5.1.

## Licensing and Attribution

As described in this README file, this repository includes modified content derived from Microsoft documentations.
These modified files **retain their original licenses** and are subject to their respective terms:

### Azure built-in roles for Storage

Portions of this repository are derived from the [Azure built-in roles for Storage](https://github.com/MicrosoftDocs/azure-docs/blob/main/articles/role-based-access-control/built-in-roles/storage.md), provided by Microsoft and licensed under the [Create Commons Attribution 4.0 International (CC BY 4.0)](https://github.com/MicrosoftDocs/azure-docs/blob/main/LICENSE) license. (You can also check the file *LICENSE_AZURE_CC_BY_4_0* in this repository).

**Modifications have been made.**

© Microsoft Corporation.

### Microsoft Entra built-in roles

Portions of this repository are derived from the [Microsoft Entra built-in roles](https://github.com/MicrosoftDocs/entra-docs/blob/main/docs/identity/role-based-access-control/permissions-reference.md), provided by Microsoft and licensed under the [MIT](https://github.com/MicrosoftDocs/entra-docs/blob/main/LICENSE) license. (You can also check the file *LICENSE_ENTRA_MIT* in this repository).

**Modifications have been made.**

© Microsoft Corporation.

### License for Original Content

All other materials (which are the evaluation scripts, the system prompts and the FindRole implementation) are licensed under the MIT license (see LICENSE file in this repository).

## Notes

- The permission requests are **not actual user queries**, but generated prompts based on modified permission descriptions.
- The data set as well as the code are provided for academic and research purposes only.
- The Microsoft data was retrieved on **April 17, 2025**. We will **not track or incorporate future updates** made to the original data sources.

## Contact

If you have any questions about the publication or the shown material, please contact max.niedermeier@tum.de

## Citation 

Paper is not yet published.
